{% extends 'base.html' %}
{% load static %}
{% load editorjs_tags %}

{% block title %}{{ post.title }}{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/essay.css' %}">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="row">
    <!-- 사이드바 -->
    <div class="col-md-3 order-md-1 order-2 mt-4 mt-md-0">
        <!-- 검색 -->
        <div class="search-box mb-4">
            <form method="get" action="{% url 'essay' %}">
                <div class="essay-search-wrap">
                    <span class="material-icons-outlined essay-search-icon">search</span>
                    <input type="text" name="q" placeholder="검색어를 입력하세요" class="essay-search-input">
                </div>
            </form>
        </div>

        <!-- 카테고리 -->
        <div class="essay-category-title">카테고리</div>
        <ul class="essay-category-list">
            <li><a href="{% url 'essay' %}">전체</a></li>
            {% for cat in categories %}
            <li><a href="{% url 'essay' %}?category={{ cat.id }}" class="{% if post.category_id == cat.id %}active{% endif %}">{{ cat.name }}</a></li>
            {% endfor %}
        </ul>
    </div>

    <!-- 글 상세 -->
    <div class="col-md-9 order-md-2 order-1">
        <a href="{% url 'essay' %}" class="back-to-list">
            <span class="material-icons-outlined">arrow_back</span> 목록으로
        </a>

        <article>
            <div class="article-header">
                <h1 class="article-title">{{ post.title }}</h1>
                <div class="article-meta">
                    {% if post.category %}
                    <span class="article-category">{{ post.category.name }}</span>
                    <span>·</span>
                    {% endif %}
                    <span>{{ post.created_at|date:"Y.m.d" }}</span>
                </div>
            </div>

            {% if post.thumbnail %}
            <div class="article-image article-thumbnail">
                <img src="{{ post.thumbnail.url }}" alt="{{ post.title }}">
            </div>
            {% endif %}

            <div class="article-body">
                {{ post.content|editorjs_render }}
            </div>

            {% if post.tags.exists %}
            <div class="article-tags">
                {% for tag in post.tags.all %}
                <span class="article-tag">{{ tag.name }}</span>
                {% endfor %}
            </div>
            {% endif %}
        </article>
    </div>
</div>
{% endblock %}
